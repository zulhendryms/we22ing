<?php

namespace App\AdminApi\Travel\Controllers;

use Validator;
use Illuminate\Http\Request;
use Illuminate\Http\Response;
use Illuminate\Support\Facades\DB;
use Illuminate\Support\Facades\Auth;
use App\Laravel\Http\Controllers\Controller;
use App\Core\Master\Entities\Item;
use App\Core\Internal\Entities\ItemType;
use App\Core\Base\Services\TravelAPIService;
use App\Core\Base\Services\HttpService;
use GuzzleHttp\Client;

class TravelAPIController extends Controller
{
    private $httpService;

    public function __construct(HttpService $httpService)
    {
        $this->client = new Client(['http_errors' => false]);
        $headers = [
            'Content-Type' => 'application/json',
            'Accept' => 'application/json',
            'Authorization' => 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImp0aSI6IjA4M2RhOWE3M2NlMmIzMzQwYTJlMTI0ZjA1MmY3MDIzMzljMGViZTY4OWRiNjQ4OGZmNjc0MGZhYTdmNzM3OGMzYmQzMzBhYWJmYTFlMTkyIn0.eyJhdWQiOiI0IiwianRpIjoiMDgzZGE5YTczY2UyYjMzNDBhMmUxMjRmMDUyZjcwMjMzOWMwZWJlNjg5ZGI2NDg4ZmY2NzQwZmFhN2Y3Mzc4YzNiZDMzMGFhYmZhMWUxOTIiLCJpYXQiOjE1NzY1NTY4NjcsIm5iZiI6MTU3NjU1Njg2NywiZXhwIjoxNzM0NDA5NjY3LCJzdWIiOiI1YjJmMGRjMi1lOWVjLTRlZmItOTg3Ni1lNTkzMjkzNzJhNDYiLCJzY29wZXMiOltdLCJjb21wIjoiNDJhZTdiZTYtMDFiNi00YWE1LTgxZTgtZDdhZDUyNmI3ZDA4In0.XoXE3nGQOm6viwEHDes8G_6aGBEaq-rM74URzuTt_mNnZqUrpe4Cvu6IJLrTAckVc-DVqMFlLLfiTqhmGZLs-bdWS7w_WXIF5evVmI5pWMb50N9UUkkxgetDnlyzZHOtMfhdINbReJL8A4UNJTJsQJmGr5ELtlFObRApvHDlM_tbKCc7KMnA32_uPAOI77LFUt3dg503titngSA2bXohEVTnoAs-cH26AmY7mEuFIHZVWPwWlfF91NhyctRYMlrQ1466IRbIQYskXtsYpnubGhe0-bn-GY6PzNDFzUCJxmUH1DOFOpZdgS3DT6-cGCPTkrebVdgXxljzwOJj78b_nPcy9rCu4ZkyprSjOYDbrFCeAZKM6hIN1rvJpAAFO6ZxMu9CpEWmMKYnryk4TKd4rXvPhMwSWAFdgG44h6QJ0nDs1eMJ4S2C2DTrJGAGuGP-ew3XSiYGHX8ylWZlcT5Yi2if0ePJY6C1aJulwIJe42fBnEzp5wAFGrK4mcCdxzYXQaER7gPlD3Hqp3ddS3bpbFvct4MCQy12hrX-k00LdFspYl_SxPxdOmyhDbdfM3Uf--_IfpR_VHh2lQx2dG-TLCCfVkxXqpHsizbWBhmjoPJfJDmM97uv6crJGIJFZbdUN4PfxXSXlBz8CQ7AmKLAp5E136nQQe5521sLJrgkH7Q'
        ];
        $this->httpService = $httpService
        // ->baseUrl('http://localhost/ezb-travel-api/public')
        ->baseUrl('http://api1.ezbooking.co:8080')
        ->headers($headers)
        ->timeout(60)
        ->json();
    }

    public function test(Request $request)
    {
        // $param = $this->apiParam($param);
        // return $this->httpService->get("/api/travel/v1/adminapi/currency?system=42ae7be6-01b6-4aa5-81e8-d7ad526b7d08");
        return $this->httpService->get("/api/travel/v1/item/attraction/list?system=42ae7be6-01b6-4aa5-81e8-d7ad526b7d08&featured=1");

    }

    private function apiParam($param = []) {
        $user = Auth::user();
        // $token ="eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImp0aSI6ImViMjlhZWEwYTRiMGI3MjEyOTNlOWI4ZWM1YjQ4ZjIzMzQ1ZWUxOWQwZjdkZjRmZDBlODdmZWFiMTkzODJkNTdmMWMzZjgyMWQ3ODM3NzA1In0.eyJhdWQiOiI0IiwianRpIjoiZWIyOWFlYTBhNGIwYjcyMTI5M2U5YjhlYzViNDhmMjMzNDVlZTE5ZDBmN2RmNGZkMGU4N2ZlYWIxOTM4MmQ1N2YxYzNmODIxZDc4Mzc3MDUiLCJpYXQiOjE1ODA5ODE5ODIsIm5iZiI6MTU4MDk4MTk4MiwiZXhwIjoxNzM4ODM0NzgyLCJzdWIiOiI1YjJmMGRjMi1lOWVjLTRlZmItOTg3Ni1lNTkzMjkzNzJhNDYiLCJzY29wZXMiOltdLCJjb21wIjoiNDJhZTdiZTYtMDFiNi00YWE1LTgxZTgtZDdhZDUyNmI3ZDA4In0.xk0AY60XqEc80YHnqWUHq5pKrHYG9LtsYZBtr3V1IHOwX2UXDo60gocUFt-HOEhJl1a813Mf9FoO46w7UQh1ncHt711UOXUsROfmWAvElOcaCNvcv5VWNBR_7zCI4L15qWZosrRpOHhDJByfgKG1wczwKl7_57axxQeWGVAMhnoBD0bKGzqkpPQ0Rch6tEbDptDfiXkwKMQ5b6MOv3LuMVmktQClj-WN_TCg2PNFhuL39xt41REOuRCbTER4uPInmr0DYoawIQdseAtsSRmsvcrSJ1aXw7_rClscWMM9F72EuevWsUwCGxOz6hw5_mnUOD9Har_xYNLgZMpDJtHgAuN3lKizooIFnBkLs-D7MtZMynGhEXEIsHKjBorxnMDpuPADYlxil3WCZgV9-EljVWxomZKPREjhf7vD1K1jczktjUeVRcse5GOTMtct7JhT72C7EAp2Xoj-j_yWXk0tSuGIOh3vgYts1nLNv0GurPakZJVHL1g-DHNSIkrLdi_aAD5nWzIC24UzSwNhV4jiwEVonnpr_MS0jnZjlxaRk-jNQIBg5rwpnQXmU8kFbOsZ1vAhHcxGMaFbodPrgqTmy93LRzuhmMHeOFQpB5QfkBJ8roEMD-8YJVdBbvo12AIiAP1EdZyVnHSWqN0HEOmbBWNkpO3zPihytaJ4UmW1XmM";
        // $this->travelAPIService->setToken($token);;
        return "system=".$user->Company."&user=".$user->Oid."&itemcontent=".$param['ItemContent']."&item=".$param['Item'];
    }
}
